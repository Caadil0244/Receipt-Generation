{% extends "base.html" %}

{% block title %}Appointment Details{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-12">
        <h2 class="text-success mb-3">
            <i class="fas fa-calendar-check me-2"></i>Appointment Details
        </h2>
    </div>
</div>

<div class="card card-green mb-4">
    <div class="card-body">
        <h5 class="card-title">Appointment with {{ appointment.customer.name }}</h5>
        <p class="card-text"><strong>Phone:</strong> {{ appointment.customer.phone or 'N/A' }}</p>
        <p class="card-text"><strong>Date & Time:</strong> {{ appointment.appointment_date.strftime('%Y-%m-%d %H:%M') }}</p>
        <p class="card-text"><strong>Description:</strong> {{ appointment.description or 'N/A' }}</p>

        <hr>

        <div class="d-flex justify-content-end">
            <a href="{{ url_for('edit_appointment', appointment_id=appointment.id) }}" class="btn btn-sm btn-warning me-2">
                <i class="fas fa-edit me-1"></i> Edit Appointment
            </a>
            <button type="button" class="btn btn-sm btn-danger" onclick="deleteAppointment('{{ appointment.id }}')">
                <i class="fas fa-trash-alt me-1"></i> Delete Appointment
            </button>
        </div>
    </div>
</div>

<div class="mt-4">
    <a href="{{ url_for('view_appointments') }}" class="btn btn-secondary">
        <i class="fas fa-arrow-left me-2"></i>Back to Appointments
    </a>
</div>

<script>
function deleteAppointment(appointmentId) {
    if (confirm('Are you sure you want to delete this appointment?')) {
        fetch(`/delete_appointment/${appointmentId}`, {
            method: 'DELETE'
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                alert('Appointment deleted successfully!');
                window.location.href = "{{ url_for('view_appointments') }}";
            } else {
                alert('Error deleting appointment: ' + data.message);
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('An error occurred while deleting the appointment.');
        });
    }
}
</script>
{% endblock %}
